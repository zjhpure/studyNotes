## 公众号(纯洁编程说：chunjie_tech)

## mysql索引和mongodb索引

mysql索引使用B+树，mongodb索引使用B树

B树(也叫B-树)特点：
1、树内的每个节点都存储数据
2、叶子节点之间无指针相邻

B+树特点：
1、数据只出现在叶子节点
2、所有叶子节点增加了一个链指针

针对B+树和B树的特点，做一个总结：
1、B树的树内存储数据，查询单条数据时查询效率不固定，最好的情况是O(1)，在做单一数据查询时，使用B树平均性能更好，但是，由于B树中各节点之间没有指针相邻，因此B树不适合做一些数据遍历操作。
2、B+树的数据只出现在叶子节点上，因此在查询单条数据时，查询速度非常稳定，因此，在做单一数据的查询上，其平均性能并不如B树，但是，B+树的叶子节点上有指针进行相连，因此在做数据遍历时，只需要对叶子节点进行遍历即可，这个特性使得B+树适合做范围查询。

B树：
一个节点存放多少数据视磁盘的数据块大小而定。
比如磁盘中1block的大小有1024KB，假设每个关键字的大小为4Byte，则可设定每一组的大小m = 1024 KB / 4 Byte = 256。
目前，多数数据库系统采用m = 200~300。
假设取m = 256，则B树存储1亿条数据的树的高度大概是log(256, 10^9) = 4，也就是单次查询所需要进行的I/O次数不超过4次，由此大大减少了I/O次数。

结论：

关系型数据库和非关系型数据的设计方式不同。

在关系型数据中，遍历操作比较常见，因此采用B+树作为索引，比较合适，所以mysql采用B+树作为索引。

而在非关系型数据库中，单一查询比较常见，因此采用B树作为索引，比较合适，所以mongodb采用B树作为索引。

问：
为什么说B+树比B树更适合实际应用中操作系统的文件索引和数据库索引？

答：
1、B+树更适合外部存储，由于内结点不存放真正的数据(只是存放其子树的最大或最小的关键字，作为索引)，一个结点可以存储更多的关键字，每个结点能索引的范围更大更精确，也意味着B+树单次磁盘IO的信息量大于B树，I/O的次数相对减少。
2、mysql是一种关系型数据库，区间访问是常见的一种情况，B+树叶结点增加的链指针，加强了区间访问性，可使用在区间查询的场景；而使用B树则无法进行区间查找。