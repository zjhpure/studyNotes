## 公众号(纯洁编程说：chunjie_tech)

## 1亿个数中找出最大的100个数(top K问题)

如何在1亿个数中找出最大的100个数(top K问题)

#### 1、全部排序

这是最容易想到的方法，然后在排序后的集合中进行查找，最快的排序算法的时间复杂度一般为O(nlogn)，例如快速排序。

但是在32位的机器上，每个float类型占4个字节，1亿个浮点数就要占用400MB的存储空间，对于一些可用内存小于400M的计算机而言，很显然是不能一次将全部数据读入内存进行排序的。

其实即使内存能够满足要求，该方法也并不高效，因为题目的目的是寻找出最大的10000个数即可，而排序却是将所有的元素都排序了，做了很多的无用功。

#### 2、局部淘汰法

该方法与排序方法类似，用一个容器保存前10000个数。

然后将剩余的所有数字——与容器内的最小数字相比，如果所有后续的元素都比容器内的10000个数还小，那么容器内这个10000个数就是最大10000个数。

如果某一后续元素比容器内最小数字大，则删掉容器内最小元素，并将该元素插入容器，最后遍历完这1亿个数，得到的结果容器中保存的数即为最终结果了。

此时的时间复杂度为O(n+m^2)，其中m为容器的大小，即10000。

#### 3、分治法

将1亿个数据分成100份，每份100万个数据，找到每份数据中最大的10000个，最后在剩下的10010000个数据里面找出最大的10000个。

如果100万数据选择足够理想，那么可以过滤掉1亿数据里面99%的数据。

100万个数据里面查找最大的10000个数据的方法如下：

用快速排序的方法，将数据分为2堆，如果大的那堆个数N大于10000个，继续对大堆快速排序一次分成2堆，如果大的那堆个数N大于10000个，继续对大堆快速排序一次分成2堆，如果大堆个数N小于10000个，就在小的那堆里面快速排序一次，找第10000-n大的数字；递归以上过程，就可以找到第1w大的数。

参考上面的找出第1w大数字，就可以类似的方法找到前10000大数字了。

此种方法需要每次的内存空间为10^64=4MB，一共需要101次这样的比较。


