## 公众号(纯洁编程说：chunjie_tech)

## 如何在海量数据中快速查找一个数字是否出现

如何在40亿个数字中快速查找一个数字是否出现？

给40亿个不重复的unsigned int的整数，没排过序的，然后再给一个数，如何快速判断这个数是否在那40亿个数当中？

注意：2^32=4294967296，42亿9千多的范围。

#### 方案1

按照将每个数字都占用一个int类型空间的方式导入内存，再来查找。

如果直接用int类型来保存所有数字到内存中，一个int类型数字就需要4个字节，那么40亿个数字就需要160亿个字节，160亿/1024/1024/1024约等于16亿g。

一次性申请16g的内存空间，这是不可取的。

#### 方案2

数据在计算机中都是以二进制格式存储的，或0或1，我们用每一个二进制位来存储一个数，存在为1，不存在为0，这样一个int可以表示32个数字。

所有的数据会只占用到16G/32 = 500MB，一般的计算机可以满足。

所以申请大约512M的内存，读入40亿个数来查找。

但是这种方法还是要占用不少的内存，不推荐。

java可以采用BitSet来保存数据，代码如下：

Gitee：

[Bitmap在Java中的应用](https://gitee.com/zjhpure/studyNotes/tree/master/src/main/algorithm/findNum/BitMap.java)

GitHub：

[Bitmap在Java中的应用](https://github.com/zjhpure/studyNotes/tree/master/src/main/algorithm/findNum/BitMap.java)

#### 方案3

这种方法可以充分利用磁盘空间，避免占用大量内存。

这里我们把40亿个数中的每一个用32位的二进制来表示，假设这40亿个数开始放在一个文件中。

把要查找的数用32位的二进制表示，查找40亿个数时，逐个位来对比。

从文件中读取40亿个数，边读边比较，先比较第一个位，如果相同保存到一个文件中。

再从这个文件中读取剩下的数，边读边比较，比较第二个位，如果相同保存到一个文件中。

.......

以此类推，当只剩下一个数时，直接把这个数和要查找的数对比是否相同，如果相同，那么找到了，否则没有找到。

时间复杂度为O(logn)。


