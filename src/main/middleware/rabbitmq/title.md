## 公众号(纯洁编程说：chunjie_tech)

rabbitmq在使用时生产端和消费端怎么保证消息发送成功？

1、消费端配置手动ack确认机制，消息被消费完成的时候，手动确认告诉mq消费成功，mq才会删除消息。

  如果消息被接收了，但是mq没有收到ack确认，那么消息在mq中会变为unacked状态。
  
  我们可以通过项目日志或者mq面板监控，当消费者断开连接之后，消息会重新回到队列中，消费者重新连接之后，会再次收到消息。
  
2、生产者端发送成功之后，在数据库中保存发送的消息和发送时间，并标记状态为未消费状态，消费者端消费完成之后，标记数据库中的数据状态为已经消费。

  消费者端通过定时任务去数据库中检索超时未被消费的消息并重新发送，解决消费失败的问题。